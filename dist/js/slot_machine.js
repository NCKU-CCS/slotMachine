!function(e){function n(e){var n={},o=e.length,l=Math.floor(Math.random()*o),s=t(e[l].phone),a=e[l].name;return console.log("luckyNUm: "+l+"  arrayLength: "+o+"\n name: "+e[l].name+"  phone: "+e[l].phone),n.luckyArray=s.array,n.phone=s.str,n.name=a,n.trueName=e[l].name,n.truePhone=e[l].phone,e.splice(l,1),n}function t(e){var n=e.split("").slice(2);return n.splice(2,3,"X","X","X"),{array:n,str:e.slice(0,4)+"XXX"+e.slice(7)}}function o(e){var n="#"+this.id,t=this.id.split("slot")[1];d++,$(n).removeClass("slot_move").addClass("slot_final"),playAudio("bgm_drop"+t,.6),d===c.length&&(i(),$(".list_box").append("<p> "+m.name+" </p>"),stopAudio("bgm_draw"),playAudio("bgm_opening",.4))}function l(e,n){$("#name").text(e),$("#phone").text(n),s(e,n)}function s(e,n){m.name=e,m.phone=n}function a(){c.forEach(function(e){$(e.el).removeClass("slot_final").addClass("slot_move"),e.start()}),$(".slot_machine").removeClass("disabled"),$(".section_led").addClass("disabled"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle"),$(".btn_draw").toggleClass("clicked"),stopAudio("bgm_opening"),playAudio("bgm_draw",.3)}function i(){$(".slot_t").addClass("draw_final_twinkle"),$(".draw_bot").addClass("wink"),$(".btn_draw").toggleClass("clicked"),$(".btn_draw").text("繼續抽")}function r(){$(".btn_draw").text("開始"),$(".btn_draw").removeClass("clicked"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle slot_move"),$(".slot_machine").addClass("disabled"),$(".section_led").removeClass("disabled"),c.forEach(function(e,n){e.reset(),$(e.el).removeClass("slot_final")}),stopAudio("bgm_draw"),playAudio("bgm_opening",.4)}var d=0,c=[new Slot("#slot1",20,35,386),new Slot("#slot2",45,20,400),new Slot("#slot3",70,30,500),new Slot("#slot4",35,25,250),new Slot("#slot5",50,15,222),new Slot("#slot6",15,25,333),new Slot("#slot7",30,13,300),new Slot("#slot8",40,50,111)],m={name:"",phone:""};LED.create(".led","Who  is  the  Lucky  Guy",120,0).show(),$(".btn_draw").click(function(){if("開始"===this.innerHTML||"繼續抽"===this.innerHTML)a(),this.innerHTML="～停～";else{var e=n(items);d=0,this.innerHTML="即將揭曉...",l(e.name,e.phone),c.forEach(function(n,t){n.stop(e.luckyArray[t])})}}),$(".btn_reset").click(function(){r()}),$(".list").click(function(){$(".list").toggleClass("list_show")}),function(e){c.forEach(function(e,n){document.getElementById("slot"+(n+1)).addEventListener("isFinal",o,!1)})}(e)}(window);