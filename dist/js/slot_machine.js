function getInitialDrawLists(){var e=[];return $.getJSON("./src/drawList.json",function(n){console.log(n,e),$.each(n,function(n,t){e.push(t)})}),e}var led=LED;Vue.component("draw-list",{props:["person"],template:'<div class="drawList_person" @click="vm.deletePerson(person)" ><div class="btn_delete_person"></div><li>{{person.name}}</li></div>'});var vm=new Vue({delimiters:["${","}"],el:"#vue_app",data:{drawLists:[],test:"hello",newPerson:{name:"",phone:""}},created:function(){var e=getInitialDrawLists();this.drawLists=e},methods:{addNewPerson:function(){var e=/^09[0-9]{8}$/;""!==this.newPerson.name.trim()&&e.test(this.newPerson.phone)?(this.drawLists.push({uid:parseInt(1e9*Math.random(),10),name:this.newPerson.name,phone:this.newPerson.phone}),this.newPerson.name="",$(".editDrawList_add_person").toggleClass("close")):alert("手機或名字填寫錯誤！")},deletePerson:function(e){this.drawLists.forEach(function(n,t){e.uid===n.uid&&(console.log(e.uid,"index: "+t,n,this),vm.drawLists.splice(t,1))})}}});!function(e){function n(e){function n(){m.forEach(function(e){$(e.el).removeClass("slot_final").addClass("slot_move"),e.start()}),$(".slot_machine").removeClass("disabled"),$(".section_led").addClass("disabled"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle"),$(".btn_draw").toggleClass("clicked"),stopAudio("bgm_opening"),playAudio("bgm_draw",.3)}function t(e){var n={},t=e.length,s=Math.floor(Math.random()*t),o=a(e[s].phone),i=e[s].name;return console.log("luckyNumber: "+s+"  arrayLength: "+t+"\n name: "+e[s].name+"  phone: "+e[s].phone),n.luckyArray=o.array,n.phone=o.str,n.name=i,n.trueName=e[s].name,n.truePhone=e[s].phone,e.splice(s,1),n}function s(e,n){$("#name").text(e),$("#phone").text(n),o(e,n)}function o(e,n){u.name=e,u.phone=n}function i(){$(".btn_draw").text("開始"),$(".btn_draw").removeClass("clicked"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle slot_move"),$(".slot_machine").addClass("disabled"),$(".section_led").removeClass("disabled"),m.forEach(function(e,n){e.reset(),$(e.el).removeClass("slot_final")}),stopAudio("bgm_draw"),playAudio("bgm_opening",.4)}function a(e){var n=e.split("").slice(2);return n.splice(2,3,"X","X","X"),{array:n,str:e.slice(0,4)+"XXX"+e.slice(7)}}function l(e){var n="#"+this.id,t=this.id.split("slot")[1];c+=1,$(n).removeClass("slot_move").addClass("slot_final"),playAudio("bgm_drop"+t,.6),c===m.length&&(r(),$(".list_box").append("<p> "+u.name+" </p>"),stopAudio("bgm_draw"),playAudio("bgm_opening",.4))}function r(){$(".slot_t").addClass("draw_final_twinkle"),$(".draw_bot").addClass("wink"),$(".btn_draw").toggleClass("clicked"),$(".btn_draw").text("繼續抽"),d()}function d(){0===vm.drawLists.length&&$(".btn_draw").html("沒有人抽了Ｑ")}var c=0,m=[new Slot("#slot1",20,35,386),new Slot("#slot2",45,20,400),new Slot("#slot3",70,30,500),new Slot("#slot4",35,25,250),new Slot("#slot5",50,15,222),new Slot("#slot6",15,25,333),new Slot("#slot7",30,13,300),new Slot("#slot8",40,50,111)],u={name:"",phone:""};led.create(".led","Who  is  the  Lucky  Guy",120,0).show(),$(".btn_draw").click(function(){if("開始"===this.innerHTML||"繼續抽"===this.innerHTML)n(),this.innerHTML="～停～";else if("～停～"===this.innerHTML){var o={};this.innerHTML="即將揭曉...",o=t(e),c=0,s(o.name,o.phone),m.forEach(function(e,n){e.stop(o.luckyArray[n])})}else alert("已經抽完獎了！我們下次再見～")}),$(".btn_reset").click(function(){i(),d()}),$(".list").click(function(){$(".list").toggleClass("list_show")}),playAudio("bgm_opening",.4),function(e){m.forEach(function(e,n){document.getElementById("slot"+(n+1)).addEventListener("isFinal",l,!1)})}(Window)}$(".btn_start").click(function(){var e=vm.drawLists;$(".tip_background, .tip_window").removeClass("fade_open"),playAudio("bgm_opening",.4),n(e)})}(Window);