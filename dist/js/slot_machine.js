!function(t){function e(t){var e={},l=t.length,s=Math.floor(Math.random()*l),a=o(t[s].phone),i=n(t[s].name);return console.log("luckyNUm: "+s+"  arrayLength: "+l),e.luckyArray=a.array,e.phone=a.str,e.name=i,e.trueName=t[s].name,e.truePhone=t[s].phone,t.splice(s,1),e}function n(t){var e=t.substr(0,1);if(t.length>=3){for(var n=0;n<t.length-2;n++)e+="X";e+=t.substr(t.length-1,1)}else e+="X";return e}function o(t){var e=t.split("").slice(2);return e.splice(2,3,"X","X","X"),{array:e,str:t.slice(0,4)+"XXX"+t.slice(7)}}function l(t){var e="#"+this.id,n=this.id.split("slot")[1];c++,$(e).removeClass("slot_move").addClass("slot_final"),playAudio("bgm_drop"+n,.6),c===u.length&&(r(),$(".list_box").append("<p> "+_.name+" </p>"),stopAudio("bgm_draw"),playAudio("bgm_opening",.4))}function s(t,e){$("#name").text(t),$("#phone").text(e),a(t,e)}function a(t,e){_.name=t,_.phone=e}function i(){u.forEach(function(t){$(t.el).removeClass("slot_final").addClass("slot_move"),t.start()}),$(".slot_machine").removeClass("disabled"),$(".section_led").addClass("disabled"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle"),$(".btn_draw").toggleClass("clicked"),stopAudio("bgm_opening"),playAudio("bgm_draw",.3)}function r(){$(".slot_t").addClass("draw_final_twinkle"),$(".draw_bot").addClass("wink"),$(".btn_draw").toggleClass("clicked"),$(".btn_draw").text("繼續抽")}function d(){$(".btn_draw").text("開始"),$(".btn_draw").removeClass("clicked"),$(".draw_bot").removeClass("wink"),$(".slot_t").removeClass("draw_final_twinkle slot_move"),$(".slot_machine").addClass("disabled"),$(".section_led").removeClass("disabled"),u.forEach(function(t,e){t.reset(),$(t.el).removeClass("slot_final")}),stopAudio("bgm_draw"),playAudio("bgm_opening",.4)}var c=0,u=[new Slot("#slot1",20,35,386),new Slot("#slot2",45,20,400),new Slot("#slot3",70,30,500),new Slot("#slot4",35,25,250),new Slot("#slot5",50,15,222),new Slot("#slot6",15,25,333),new Slot("#slot7",30,13,300),new Slot("#slot8",40,50,111)],_={name:"",phone:""};LED.create(".led","Who  is  the  Lucky  Guy",120,0).show(),$(".btn_draw").click(function(){if("開始"===this.innerHTML||"繼續抽"===this.innerHTML)i(),this.innerHTML="～停～";else{var t=e(items);c=0,this.innerHTML="即將揭曉...",s(t.name,t.phone),u.forEach(function(e,n){e.stop(t.luckyArray[n])})}}),$(".btn_reset").click(function(){d()}),$(".list").click(function(){$(".list").toggleClass("list_show")}),function(t){u.forEach(function(t,e){document.getElementById("slot"+(e+1)).addEventListener("isFinal",l,!1)})}(t)}(window);